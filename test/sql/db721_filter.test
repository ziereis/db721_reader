# name: test/sql/db721_filter.test
# description: test db721 filter
# group: [filter123]

require db721

#should completely skip the read just from the stats
query I
SELECT COUNT(*) FROM db721_scan('data/data-chickens.db721') WHERE sex = 'ZOO';
----
0

#should skip the first and second row group
query I
SELECT * FROM db721_scan('data/data-chickens.db721') WHERE farm_name = 'Incubator';
----
10000

#just random querys i verified with the csv reader
query I
SELECT COUNT(*) FROM  db721_scan('data/data-chickens.db721') WHERE sex = 'MALE';
----
45129

query I
SELECT COUNT(*) FROM  db721_scan('data/data-chickens.db721')
WHERE sex = 'FEMALE' AND age_weeks > 0.5 AND age_weeks < 2;
----
11647


query I
SELECT COUNT(*) FROM  db721_scan('data/data-chickens.db721')
WHERE sex = 'FEMALE' AND age_weeks > 0.5 AND age_weeks < 2
OR farm_name != 'Cheep Birds' AND weight_g < 700;
----
22721


#very selective
query IIIIIII
SELECT * FROM db721_scan('data/data-chickens.db721') WHERE age_weeks < 0.01;
----
1418	Cheep Birds	GOMPERTZ	FEMALE	0.0	589.592919104762	WOODY
1960	Cheep Birds	MMF	FEMALE	0.0	593.8101683568682	WOODY
2999	Cheep Birds	MMF	MALE	0.0	571.089659658064	WOODY
3827	Cheep Birds	WEIBULL	FEMALE	0.0	764.9401184705598	WOODY
5078	Cheep Birds	WEIBULL	FEMALE	0.0	855.4811067599021	WOODY
8368	Cheep Birds	GOMPERTZ	MALE	0.0	760.3970138665189	WOODY
11472	Cheep Birds	MMF	MALE	0.0	523.1990847600526	WOODY
12848	Cheep Birds	MMF	FEMALE	0.0	760.2221891508048	WOODY
13761	Cheep Birds	GOMPERTZ	FEMALE	0.0	581.9910517735098	WOODY
14951	Cheep Birds	GOMPERTZ	MALE	0.0	897.7570944825889	WOODY
16194	Cheep Birds	GOMPERTZ	MALE	0.0	689.2480201737358	WOODY
16597	Cheep Birds	GOMPERTZ	FEMALE	0.0	477.0729621307481	WOODY
17218	Cheep Birds	GOMPERTZ	MALE	0.0	794.0506360141362	WOODY
18003	Cheep Birds	GOMPERTZ	MALE	0.0	568.2503259081136	WOODY
18493	Cheep Birds	WEIBULL	MALE	0.0	778.7071357242937	WOODY
19992	Cheep Birds	WEIBULL	MALE	0.0	424.9085019830034	WOODY
22493	Cheep Birds	MMF	FEMALE	0.0	815.7699355934074	WOODY
24714	Cheep Birds	WEIBULL	FEMALE	0.0	626.3402395611965	WOODY
27429	Cheep Birds	WEIBULL	FEMALE	0.0	533.244995360147	WOODY
27826	Cheep Birds	GOMPERTZ	FEMALE	0.0	745.0185858188769	WOODY
29796	Cheep Birds	MMF	MALE	0.0	899.5203512242625	WOODY
29819	Cheep Birds	WEIBULL	FEMALE	0.0	745.9919545651039	WOODY
32670	Cheep Birds	WEIBULL	MALE	0.0	779.2503873924284	WOODY
32761	Cheep Birds	WEIBULL	FEMALE	0.0	613.260421538416	WOODY
33593	Cheep Birds	WEIBULL	MALE	0.0	793.485425670042	WOODY
35885	Cheep Birds	WEIBULL	FEMALE	0.0	616.8807476407022	WOODY
36215	Cheep Birds	MMF	MALE	0.0	523.3535088737675	WOODY
38051	Cheep Birds	GOMPERTZ	MALE	0.0	409.16745997187877	WOODY
38575	Cheep Birds	WEIBULL	FEMALE	0.0	932.228503268688	WOODY
38709	Cheep Birds	MMF	FEMALE	0.0	623.9985541221665	WOODY
39176	Cheep Birds	GOMPERTZ	FEMALE	0.0	704.3602328820709	WOODY
39519	Cheep Birds	MMF	MALE	0.0	856.3914998897997	WOODY
40251	Cheep Birds	WEIBULL	MALE	0.0	1004.956893408852	WOODY
42870	Cheep Birds	MMF	FEMALE	0.0	726.7596281637	WOODY
45158	Cheep Birds	GOMPERTZ	MALE	0.0	785.0269337088683	WOODY
46730	Cheep Birds	GOMPERTZ	MALE	0.0	782.6786619975446	WOODY
47854	Cheep Birds	MMF	FEMALE	0.0	526.7511097355706	WOODY
48107	Cheep Birds	GOMPERTZ	FEMALE	0.0	918.961467702516	WOODY
48689	Cheep Birds	MMF	FEMALE	0.0	826.3606551787752	WOODY
48691	Cheep Birds	GOMPERTZ	FEMALE	0.0	570.2659371580871	WOODY
48801	Cheep Birds	WEIBULL	MALE	0.0	429.41894677021236	WOODY
49678	Cheep Birds	GOMPERTZ	FEMALE	0.0	907.8290020046127	WOODY
80962	Cheep Birds	GOMPERTZ	MALE	0.0	536.5239629428265	WOODY
81648	Dish of the Day	WEIBULL	MALE	0.0	236.84	NULL
83799	Breakfast Lunch Dinner	MMF	MALE	0.0	449.42	NULL
84332	Cheep Birds	GOMPERTZ	MALE	0.0	668.3043364366788	WOODY
86953	Breakfast Lunch Dinner	WEIBULL	MALE	0.0	161.09	NULL
87442	Cheep Birds	WEIBULL	FEMALE	0.0	693.705890248835	WOODY
88191	Breakfast Lunch Dinner	WEIBULL	FEMALE	0.0	185.37	NULL
88874	Breakfast Lunch Dinner	MMF	MALE	0.0	391.51	NULL
89242	Dish of the Day	WEIBULL	MALE	0.0	69.56	NULL
89262	Breakfast Lunch Dinner	GOMPERTZ	MALE	0.0	86.92	NULL
91605	Breakfast Lunch Dinner	MMF	MALE	0.0	197.19	NULL
100355	Cheep Birds	WEIBULL	MALE	0.0	536.3980458141893	WOODY
100789	Dish of the Day	WEIBULL	MALE	0.0	481.73	NULL
101339	Dish of the Day	MMF	MALE	0.0	483.39	NULL
110328	Incubator	MMF	MALE	0.0	348.39	NULL
110366	Incubator	GOMPERTZ	MALE	0.0	333.99	NULL
110645	Incubator	GOMPERTZ	MALE	0.0	348.28	NULL
110826	Incubator	WEIBULL	MALE	0.0	105.72	NULL
111267	Incubator	WEIBULL	MALE	0.0	166.92	NULL
111773	Incubator	GOMPERTZ	FEMALE	0.0	263.59	NULL
113048	Incubator	GOMPERTZ	MALE	0.0	466.11	NULL
114209	Incubator	WEIBULL	FEMALE	0.0	407.66	NULL
114955	Incubator	MMF	MALE	0.0	211.3	NULL
114959	Incubator	WEIBULL	FEMALE	0.0	372.5	NULL
115571	Incubator	WEIBULL	MALE	0.0	419.19	NULL
115707	Incubator	WEIBULL	MALE	0.0	388.5	NULL
115751	Incubator	GOMPERTZ	FEMALE	0.0	122.11	NULL
115835	Incubator	MMF	FEMALE	0.0	70.84	NULL
116348	Incubator	MMF	FEMALE	0.0	101.82	NULL
116367	Incubator	GOMPERTZ	FEMALE	0.0	262.37	NULL
116685	Incubator	GOMPERTZ	FEMALE	0.0	110.02	NULL
116760	Incubator	MMF	FEMALE	0.0	276.99	NULL
117255	Incubator	GOMPERTZ	FEMALE	0.0	370.83	NULL
117325	Incubator	GOMPERTZ	FEMALE	0.0	171.32	NULL
118132	Incubator	WEIBULL	MALE	0.0	354.75	NULL
118743	Incubator	GOMPERTZ	MALE	0.0	367.93	NULL
119128	Incubator	WEIBULL	MALE	0.0	178.84	NULL
119309	Incubator	GOMPERTZ	FEMALE	0.0	379.28	NULL
119573	Incubator	WEIBULL	MALE	0.0	390.14	NULL